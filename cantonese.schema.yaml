# Rime schema
# encoding: utf-8

schema:
  schema_id: cantonese
  name: 粵語拼音
  version: 20190905 V1.0.01
  author:
  - sgal <1727246457@qq.com>
  dependencies:
  - luna_pinyin
  description: |-
    本方案爲聲調粵拼方案，由 sgal 製作。
    詞典資料來自 https://github.com/sgalal/lexi_can_crawler。
    本方案依賴 luna_pinyin 方案。

switches:
- name: ascii_mode
  states: [ 中文, 西文 ]
- name: full_shape
  reset: 0
- options: [ traditional, simplification ]
  states: [ 繁體, 简体 ]
- name: ascii_punct
  reset: 0

engine:
  processors:
  - ascii_composer
  - recognizer
  - key_binder
  - speller
  - punctuator
  - selector
  - navigator
  - express_editor
  segmentors:
  - ascii_segmentor
  - matcher
  - affix_segmentor@luna_pinyin
  - abc_segmentor
  - punct_segmentor
  - fallback_segmentor
  translators:
  - punct_translator
  - script_translator
  - script_translator@luna_pinyin
  filters:
  - simplifier
  - simplifier@luna_pinyin_simplifier
  - simplifier@traditional
  - uniquifier
  - reverse_lookup_filter@luna_pinyin_reverse_lookup

key_binder:
  import_preset: default

speller:
  algebra:
  - xform/[1-6]$//              # 去除聲調
  - derive/^(.).+$/$1/          # 首字母簡拼

translator:
  dictionary: cantonese
  spelling_hints: 20
  comment_format:
  - "xform/^(.+)$/$1 /"           # Force comment display, even when the strings are identical

luna_pinyin:
  dictionary: luna_pinyin
  prefix: "`"
  suffix: ";"
  tips: 『拼音』
  tag: luna_pinyin

luna_pinyin_reverse_lookup:
  dictionary: cantonese
  overwrite_comment: true
  tags: [ luna_pinyin ]

simplifier:
  import_preset: default
  option_name: simplification
  opencc_config: hk2s.json
  tags: [ abc ]

luna_pinyin_simplifier:
  import_preset: default
  option_name: simplification
  tags: [ luna_pinyin ]

traditional:
  import_preset: default
  option_name: traditional
  opencc_config: t2hk.json
  tags: [ abc, luna_pinyin ]

punctuator:
  import_preset: default

recognizer:
  import_preset: default
  patterns:
    luna_pinyin: "^`[a-z']*;?$"        # 按 ` 進入拼音反查
